$OpenBSD$

Index: newlib/libm/math/ef_sqrt.c
--- newlib/libm/math/ef_sqrt.c.orig
+++ newlib/libm/math/ef_sqrt.c
@@ -13,6 +13,11 @@
  * ====================================================
  */
 
+/* TENSILICA: Avoid the hassle of tpp and other conditionals with
+   FP by using a function in libgcc instead of this one when
+   fp is present.  */
+
+#include <xtensa/config/core-isa.h>
 #include "fdlibm.h"
 
 #ifdef __STDC__
@@ -21,6 +26,8 @@ static	const float	one	= 1.0, tiny=1.0e-30;
 static	float	one	= 1.0, tiny=1.0e-30;
 #endif
 
+#if !XCHAL_HAVE_FP_SQRT
+
 #ifdef __STDC__
 	float __ieee754_sqrtf(float x)
 #else
@@ -87,3 +94,6 @@ static	float	one	= 1.0, tiny=1.0e-30;
 	SET_FLOAT_WORD(z,ix);
 	return z;
 }
+
+#endif /* !XCHAL_HAVE_FP_SQRT */
+
